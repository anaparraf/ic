---
title: "PIBIC - Detecção e avaliação de viés de aprendizado de máquina utilizando
  o Censo Demográfico"
author: "Ana Beatriz Parra Ferreira"
date: "2024-08-11"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, cache.lazy = FALSE) 
setwd("C:/Users/anapa/Iniciação científica/git")
```

## Chamando as bibliotecas necessárias

```{r bibliotecas}
# install.packages("censobr")  #instalar biblioteca do censo
library(censobr)
library(tidyverse)
```

## Leitura dos dados do Censo

O censobr é um pacote útil que facilita o acesso e a análise de dados do Censo Demográfico Brasileiro diretamente no ambiente R. Após instalar a biblioteca, é possível baixar e trabalhar com informações detalhadas sobre a população e os domicílios do Brasil, coletadas pelo IBGE. 

Para a pesquisa, o ano utilizado será o de 2010. As variáveis de interesse e seus códigos são: 

code_muni: código do município
abbrev_state: estado
V0002: codigo municipio
V0601: sexo
V6036: idade
V0606: cor ou raça
V6400: nível de instrução 
V6525: rendimento em todos os trabalhos
V6930: posição na ocupação e categoria do
emprego no trabalho principal


```{r lendo}
#definindo variáveis
colunas = c('code_muni','abbrev_state', 'V0002', 'V0601', 'V6036', 'V0606','V6400','V6525','V6930')

pop <- read_population(
  year = 2010,          # year of reference
  columns = colunas,       # select columns to read
  add_labels = 'pt',    # add labels to categorical variables
  as_data_frame = TRUE, # return an Arrow DataSet se FALSE, data.frame se TRUE
  showProgress = TRUE,  # show download progress bar
  cache = TRUE       # cache data for faster access later
  )
```


Renomeando as variáveis e filtrando valores não nulos de rendimento total 

```{r renomeando}
dados <- pop |> 
  rename(sexo = V0002, idade = V6036, cor_raca = V0606, nivel_instrucao = V6400, 
         rendimento = V6525, ocupacao_emprego = V6930) |> 
  filter(rendimento != is.na(rendimento))

head(pop)
```

## Download do dataframe

```{r  baixando}
write_csv(dados, "dados/censo.csv") 
```

## Apêndice

Dicionário de variáveis de população do censo: 

```{r dicionario - dados, }
data_dictionary(year = 2010, dataset = "population")
```